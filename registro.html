<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro - Guau&Miau</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<style>
    body {
        margin-top: 0;
        padding: 0;
    }

    #logo-miauguau {
        width: 320px;
        border-radius: 16px;
    }

    #navbar-miauguau {
        background-color: rgb(163, 207, 238);
        padding: 10px;
    }
    .nav-link{
        color: aliceblue;
    }
</style>

<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-light py-0">
            <div class="container-fluid px-5" id="navbar-miauguau">
                <!-- Home - Izquierda -->
                <div class="navbar-nav">
                    <a class="nav-link" href="index.html">Inicio</a>
                </div>

                <!-- Logo - Centro -->
                <a class="navbar-brand mx-auto" href="#">
                    <img id="logo-miauguau" src="assets/img/logo-miauguau.png" alt="logo-miauguau">
                </a>

                <!-- Botón Iniciar Sesión - Derecha -->
                <div class="navbar-nav">
                    <a class="btn btn-dark" href="login.html">Iniciar Sesión</a>
                </div>
            </div>
        </nav>
    </header>
    <main>
        <section class="container my-5">
            <div class="row justify-content-center">
                <div class="col-md-6 col-lg-4">
                    <div class="card shadow">
                        <div class="card-body">
                            <h3 class="card-title text-center mb-4" >Registro de Usuario</h3>
                            <form id="formulario-registro">
                                <!-- Datos del Usuario -->
                                <div class="mb-3">
                                    <label for="form-nombre" class="form-label">Nombre <span
                                            style="color: #dc3545;">*</span></label>
                                    <input type="text" class="form-control" id="form-nombre"
                                        placeholder="Ingresa tu nombre" required>
                                </div>
                                <div class="mb-3">
                                    <label for="form-apellido" class="form-label">Apellido <span
                                            style="color: #dc3545;">*</span></label>
                                    <input type="text" class="form-control" id="form-apellido"
                                        placeholder="Ingresa tu apellido" required>
                                </div>
                                <div class="mb-3">
                                    <label for="form-correo" class="form-label">Correo Electrónico<span
                                            style="color: #dc3545;">*</span></label>
                                    <input type="email" class="form-control" id="form-correo"
                                        placeholder="usuario@duoc.cl" pattern="[a-zA-Z0-9._%+-]+@duoc\.cl$" required>
                                    <div class="form-text">
                                        <small class="text-muted">Solo se aceptan correos con dominio @duoc.cl</small>
                                    </div>
                                    <div class="invalid-feedback" id="correo-error">
                                        El correo debe tener el formato usuario@duoc.cl
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="form-pass" class="form-label">Contraseña<span
                                            style="color: #dc3545;">*</span></label>
                                    <input type="password" class="form-control" id="form-pass"
                                        placeholder="Mínimo 8 caracteres" required>
                                </div>
                                <div class="mb-3">
                                    <label for="form-confirmpass" class="form-label">Confirmar Contraseña<span
                                            style="color: #dc3545;">*</span></label>
                                    <input type="password" class="form-control" id="form-confirmpass"
                                        placeholder="Repite tu contraseña" required>
                                </div>
                                <div class="mb-3">
                                    <label for="form-telefono" class="form-label">Número de teléfono (opcional)</label>
                                    <input type="tel" class="form-control" id="form-telefono"
                                        placeholder="Ingrese número telefónico">
                                </div>

                                <!-- Sección de Mascotas -->
                                <hr class="my-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h5 class="mb-0">Registro de Mascotas</h5>
                                    <button type="button" class="btn btn-outline-dark btn-sm"
                                        id="agregar-nuevo-registro">
                                        Añadir nuevo registro
                                    </button>
                                </div>

                                <!-- Contenedor de registros de mascotas -->
                                <div id="registros-mascotas" class="mb-3">
                                    <!-- Los registros de mascotas se agregarán aquí dinámicamente -->
                                </div>

                                <div class="d-grid">
                                    <button type="submit" class="btn btn-dark btn-lg">Registrar Usuario</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>
    <footer>

    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let contadorMascotas = 0;

        // Función para crear una nueva sección de mascota
        function crearSeccionMascota() {
            contadorMascotas++;
            const registrosMascotas = document.getElementById('registros-mascotas');

            const seccionMascota = document.createElement('div');
            seccionMascota.className = 'border rounded p-3 mb-3';
            seccionMascota.id = `mascota-${contadorMascotas}`;

            seccionMascota.innerHTML = `
                <div class="row">
                    <div class="col-12">
                        <label for="nombre-mascota-${contadorMascotas}" class="form-label">Nombre<span style="color: #dc3545;">*</span></label>
                        <input type="text" class="form-control" id="nombre-mascota-${contadorMascotas}" 
                            placeholder="Nombre de la mascota">
                    </div>
                                         <div class="col-12">
                         <label for="tipo-mascota-${contadorMascotas}" class="form-label">Tipo<span style="color: #dc3545;">*</span></label>
                         <div class="d-flex align-items-center">
                             <select class="form-select me-2" id="tipo-mascota-${contadorMascotas}">
                                 <option value="">Seleccionar...</option>
                                 <option value="perro">Perro</option>
                                 <option value="gato">Gato</option>
                                 <option value="ave">Ave</option>
                                 <option value="otro">Otro</option>
                             </select>
                             <button type="button" class="btn btn-outline-danger btn-sm d-flex align-items-center justify-content-center" 
                                     style="width: 40px; height: 38px; min-width: 40px;" 
                                     onclick="eliminarMascota(${contadorMascotas})">
                                 <span style="font-size: 16px; font-weight: bold;">×</span>
                             </button>
                         </div>
                     </div>
                </div>
            `;

            registrosMascotas.appendChild(seccionMascota);
        }

        // Función para eliminar una mascota
        function eliminarMascota(id) {
            const mascota = document.getElementById(`mascota-${id}`);
            if (mascota) {
                mascota.remove();
            }
        }

        // Event listener para agregar nuevo registro
        document.getElementById('agregar-nuevo-registro').addEventListener('click', function () {
            crearSeccionMascota();
        });

        // Validación del correo electrónico
        function validarCorreoDuoc(correo) {
            const regex = /^[a-zA-Z0-9._%+-]+@duoc\.cl$/;
            return regex.test(correo);
        }
        
        // Event listener para validar correo en tiempo real
        document.getElementById('form-correo').addEventListener('blur', function() {
            const correo = this.value.trim();
            const correoError = document.getElementById('correo-error');
            
            if (correo && !validarCorreoDuoc(correo)) {
                this.classList.add('is-invalid');
                this.classList.remove('is-valid');
                correoError.style.display = 'block';
            } else if (correo && validarCorreoDuoc(correo)) {
                this.classList.remove('is-invalid');
                this.classList.add('is-valid');
                correoError.style.display = 'none';
            } else {
                this.classList.remove('is-invalid', 'is-valid');
                correoError.style.display = 'none';
            }
        });
        
        // Validación del formulario principal
        document.getElementById('formulario-registro').addEventListener('submit', function (e) {
            e.preventDefault();

            const correo = document.getElementById('form-correo').value.trim();
            const password = document.getElementById('form-pass').value;
            const confirmPassword = document.getElementById('form-confirmpass').value;

            // Validar correo @duoc.cl
            if (!validarCorreoDuoc(correo)) {
                alert('El correo electrónico debe tener el formato usuario@duoc.cl');
                document.getElementById('form-correo').focus();
                return;
            }

            if (password !== confirmPassword) {
                alert('Las contraseñas no coinciden');
                return;
            }

            // Recopilar datos de mascotas
            const mascotas = [];
            const seccionesMascotas = document.querySelectorAll('[id^="mascota-"]');

            seccionesMascotas.forEach(seccion => {
                const nombreInput = seccion.querySelector('input[type="text"]');
                const tipoSelect = seccion.querySelector('select');

                if (nombreInput.value.trim() && tipoSelect.value) {
                    mascotas.push({
                        nombre: nombreInput.value.trim(),
                        tipo: tipoSelect.value
                    });
                }
            });

            console.log('Usuario registrado con mascotas:', mascotas);
            alert(`Usuario registrado exitosamente con ${mascotas.length} mascota(s)`);
        });
    </script>
</body>

</html>